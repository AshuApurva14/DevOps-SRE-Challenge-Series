<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.12/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.documentElement.classList.add("markmap-dark");
              }
            })(() => window.markmap,null,{"content":"Grafana + Jenkins behind Nginx (HTTPS + Basic Auth)","children":[{"content":"Solution - Day 3 Challenge: Multi-Service Reverse Proxy with Nginx","children":[],"payload":{"tag":"h2","lines":"3,4"}},{"content":"Overview","children":[],"payload":{"tag":"h2","lines":"6,7"}},{"content":"Prerequisites","children":[{"content":"Windows (PowerShell); commands below assume PowerShell execution.","children":[],"payload":{"tag":"li","lines":"14,15"}},{"content":"Docker &amp; Docker Compose (or Docker Desktop).","children":[],"payload":{"tag":"li","lines":"15,16"}},{"content":"OpenSSL available in PowerShell, WSL, Git Bash, or installed separately.","children":[],"payload":{"tag":"li","lines":"16,17"}},{"content":"Administrator privileges to edit the hosts file.","children":[],"payload":{"tag":"li","lines":"17,19"}}],"payload":{"tag":"h2","lines":"12,13"}},{"content":"High-level Steps","children":[{"content":"Add local host entries for <code>grafana.local</code> and <code>jenkins.local</code>.","children":[],"payload":{"tag":"li","lines":"21,22"}},{"content":"Generate a self-signed certificate with SAN entries for both domains.","children":[],"payload":{"tag":"li","lines":"22,23"}},{"content":"Create an <code>htpasswd</code> file for Basic Auth.","children":[],"payload":{"tag":"li","lines":"23,24"}},{"content":"Run Grafana and Jenkins containers.","children":[],"payload":{"tag":"li","lines":"24,25"}},{"content":"Run an Nginx reverse proxy that forwards to each service, enforces Basic Auth, and serves HTTPS.","children":[],"payload":{"tag":"li","lines":"25,26"}},{"content":"Validate access and HTTP &#x2192; HTTPS redirection.","children":[],"payload":{"tag":"li","lines":"26,28"}}],"payload":{"tag":"h2","lines":"19,20"}},{"content":"1) Hosts file","children":[{"content":"<pre data-lines=\"34,38\"><code class=\"language-powershell\"><span class=\"hljs-comment\"># Open hosts file in Notepad (run PowerShell as Administrator)</span>\nnotepad C:\\Windows\\System32\\drivers\\etc\\hosts\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"34,38"}},{"content":"<pre data-lines=\"41,45\"><code data-lines=\"41,45\"><span class=\"hljs-number\">127.0.0.1</span> grafana.local\n<span class=\"hljs-number\">127.0.0.1</span> jenkins.local\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"41,45"}}],"payload":{"tag":"h2","lines":"30,31"}},{"content":"2) Workspace layout","children":[{"content":"<pre data-lines=\"52,58\"><code class=\"language-powershell\">mkdir -Force .\\proxy\nmkdir -Force .\\proxy\\conf.d\nmkdir -Force .\\proxy\\certs\nmkdir -Force .\\proxy\\auth\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"52,58"}}],"payload":{"tag":"h2","lines":"48,49"}},{"content":"3) Generate a self-signed certificate (SAN)","children":[{"content":"<pre data-lines=\"63,98\"><code class=\"language-powershell\"><span class=\"hljs-comment\"># Create a CSR config file (writes to .\\proxy\\certs\\csr.conf)</span>\n<span class=\"hljs-string\">@&quot;\n[req]\ndefault_bits = 2048\nprompt = no\ndefault_md = sha256\nreq_extensions = req_ext\ndistinguished_name = dn\n\n[dn]\nC=US\nST=State\nL=City\nO=DevOps\nOU=Local\nCN = grafana.local\n\n[req_ext]\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = grafana.local\nDNS.2 = jenkins.local\n&quot;@</span> | <span class=\"hljs-built_in\">Out-File</span> <span class=\"hljs-literal\">-Encoding</span> ascii .\\proxy\\certs\\csr.conf\n\n<span class=\"hljs-comment\"># Generate private key</span>\nopenssl genrsa <span class=\"hljs-literal\">-out</span> .\\proxy\\certs\\local.key <span class=\"hljs-number\">2048</span>\n\n<span class=\"hljs-comment\"># Generate CSR</span>\nopenssl req <span class=\"hljs-literal\">-new</span> <span class=\"hljs-literal\">-key</span> .\\proxy\\certs\\local.key <span class=\"hljs-literal\">-out</span> .\\proxy\\certs\\local.csr <span class=\"hljs-literal\">-config</span> .\\proxy\\certs\\csr.conf\n\n<span class=\"hljs-comment\"># Self-sign certificate (valid 10 years here)</span>\nopenssl x509 <span class=\"hljs-literal\">-req</span> <span class=\"hljs-operator\">-in</span> .\\proxy\\certs\\local.csr <span class=\"hljs-literal\">-signkey</span> .\\proxy\\certs\\local.key <span class=\"hljs-literal\">-out</span> .\\proxy\\certs\\local.crt <span class=\"hljs-literal\">-days</span> <span class=\"hljs-number\">3650</span> <span class=\"hljs-literal\">-extensions</span> req_ext <span class=\"hljs-literal\">-extfile</span> .\\proxy\\certs\\csr.conf\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"63,98"}},{"content":"<pre data-lines=\"101,105\"><code class=\"language-powershell\"><span class=\"hljs-built_in\">copy</span> .\\proxy\\certs\\local.crt .\\proxy\\certs\\local.pem\n<span class=\"hljs-built_in\">Get-Content</span> .\\proxy\\certs\\local.key | <span class=\"hljs-built_in\">Out-File</span> <span class=\"hljs-literal\">-Append</span> <span class=\"hljs-literal\">-Encoding</span> ascii .\\proxy\\certs\\local.pem\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"101,105"}}],"payload":{"tag":"h2","lines":"59,60"}},{"content":"4) Create Basic Auth credentials (htpasswd)","children":[{"content":"<pre data-lines=\"112,116\"><code class=\"language-powershell\">docker run <span class=\"hljs-literal\">--rm</span> httpd:<span class=\"hljs-number\">2.4</span> htpasswd <span class=\"hljs-literal\">-Bbn</span> admin StrongPass123 &gt; .\\proxy\\auth\\htpasswd\n<span class=\"hljs-built_in\">Get-Content</span> .\\proxy\\auth\\htpasswd\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"112,116"}}],"payload":{"tag":"h2","lines":"108,109"}},{"content":"5) Run Grafana and Jenkins (Docker)","children":[{"content":"<pre data-lines=\"121,124\"><code class=\"language-powershell\">docker run <span class=\"hljs-literal\">-d</span> <span class=\"hljs-literal\">--name</span> grafana <span class=\"hljs-literal\">-e</span> <span class=\"hljs-string\">&quot;GF_SECURITY_ADMIN_PASSWORD=admin&quot;</span> <span class=\"hljs-literal\">-p</span> <span class=\"hljs-number\">3000</span>:<span class=\"hljs-number\">3000</span> grafana/grafana:latest\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"121,124"}},{"content":"<pre data-lines=\"127,130\"><code class=\"language-powershell\">docker run -d --name jenkins -p 8080:8080 -p 50000:50000 -v jenkins_home:/var/jenkins_home jenkins/jenkins:lts\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"127,130"}},{"content":"<pre data-lines=\"133,136\"><code class=\"language-powershell\">docker logs <span class=\"hljs-operator\">-f</span> jenkins\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"133,136"}}],"payload":{"tag":"h2","lines":"117,118"}},{"content":"6) Nginx reverse proxy configuration","children":[{"content":"<pre data-lines=\"141,191\"><code data-lines=\"141,191\"><span class=\"hljs-comment\"># Redirect HTTP to HTTPS</span>\n<span class=\"hljs-section\">server</span> {\n    <span class=\"hljs-attribute\">listen</span> <span class=\"hljs-number\">80</span>;\n    <span class=\"hljs-attribute\">server_name</span> grafana.local jenkins.local;\n    <span class=\"hljs-attribute\">return</span> <span class=\"hljs-number\">301</span> https://<span class=\"hljs-variable\">&#x24;host</span><span class=\"hljs-variable\">&#x24;request_uri</span>;\n}\n\n<span class=\"hljs-comment\"># Grafana HTTPS</span>\n<span class=\"hljs-section\">server</span> {\n    <span class=\"hljs-attribute\">listen</span> <span class=\"hljs-number\">443</span> ssl;\n    <span class=\"hljs-attribute\">server_name</span> grafana.local;\n\n    <span class=\"hljs-attribute\">ssl_certificate</span> /etc/nginx/certs/local.crt;\n    <span class=\"hljs-attribute\">ssl_certificate_key</span> /etc/nginx/certs/local.key;\n    <span class=\"hljs-attribute\">ssl_protocols</span> TLSv1.<span class=\"hljs-number\">2</span> TLSv1.<span class=\"hljs-number\">3</span>;\n    <span class=\"hljs-attribute\">ssl_prefer_server_ciphers</span> <span class=\"hljs-literal\">on</span>;\n\n    <span class=\"hljs-section\">location</span> / {\n        <span class=\"hljs-attribute\">auth_basic</span> <span class=\"hljs-string\">&quot;Restricted&quot;</span>;\n        <span class=\"hljs-attribute\">auth_basic_user_file</span> /etc/nginx/auth/htpasswd;\n        <span class=\"hljs-attribute\">proxy_pass</span> http://host.docker.internal:3000;\n        <span class=\"hljs-attribute\">proxy_set_header</span> Host <span class=\"hljs-variable\">&#x24;host</span>;\n        <span class=\"hljs-attribute\">proxy_set_header</span> X-Real-IP <span class=\"hljs-variable\">&#x24;remote_addr</span>;\n        <span class=\"hljs-attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"hljs-variable\">&#x24;proxy_add_x_forwarded_for</span>;\n        <span class=\"hljs-attribute\">proxy_set_header</span> X-Forwarded-Proto <span class=\"hljs-variable\">&#x24;scheme</span>;\n    }\n}\n\n<span class=\"hljs-comment\"># Jenkins HTTPS</span>\n<span class=\"hljs-section\">server</span> {\n    <span class=\"hljs-attribute\">listen</span> <span class=\"hljs-number\">443</span> ssl;\n    <span class=\"hljs-attribute\">server_name</span> jenkins.local;\n\n    <span class=\"hljs-attribute\">ssl_certificate</span> /etc/nginx/certs/local.crt;\n    <span class=\"hljs-attribute\">ssl_certificate_key</span> /etc/nginx/certs/local.key;\n    <span class=\"hljs-attribute\">ssl_protocols</span> TLSv1.<span class=\"hljs-number\">2</span> TLSv1.<span class=\"hljs-number\">3</span>;\n    <span class=\"hljs-attribute\">ssl_prefer_server_ciphers</span> <span class=\"hljs-literal\">on</span>;\n\n    <span class=\"hljs-section\">location</span> / {\n        <span class=\"hljs-attribute\">auth_basic</span> <span class=\"hljs-string\">&quot;Restricted&quot;</span>;\n        <span class=\"hljs-attribute\">auth_basic_user_file</span> /etc/nginx/auth/htpasswd;\n        <span class=\"hljs-attribute\">proxy_pass</span> http://host.docker.internal:8080;\n        <span class=\"hljs-attribute\">proxy_set_header</span> Host <span class=\"hljs-variable\">&#x24;host</span>;\n        <span class=\"hljs-attribute\">proxy_set_header</span> X-Real-IP <span class=\"hljs-variable\">&#x24;remote_addr</span>;\n        <span class=\"hljs-attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"hljs-variable\">&#x24;proxy_add_x_forwarded_for</span>;\n        <span class=\"hljs-attribute\">proxy_set_header</span> X-Forwarded-Proto <span class=\"hljs-variable\">&#x24;scheme</span>;\n    }\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"141,191"}},{"content":"<pre data-lines=\"198,202\"><code class=\"language-powershell\"><span class=\"hljs-comment\"># If your current path has spaces, wrap paths in quotes.</span>\ndocker run <span class=\"hljs-literal\">-d</span> <span class=\"hljs-literal\">--name</span> reverse<span class=\"hljs-literal\">-proxy</span> <span class=\"hljs-literal\">-p</span> <span class=\"hljs-number\">80</span>:<span class=\"hljs-number\">80</span> <span class=\"hljs-literal\">-p</span> <span class=\"hljs-number\">443</span>:<span class=\"hljs-number\">443</span> <span class=\"hljs-literal\">-v</span> <span class=\"hljs-string\">&quot;<span class=\"hljs-variable\">&#x24;</span>{PWD}\\proxy\\conf.d:/etc/nginx/conf.d:ro&quot;</span> <span class=\"hljs-literal\">-v</span> <span class=\"hljs-string\">&quot;<span class=\"hljs-variable\">&#x24;</span>{PWD}\\proxy\\certs:/etc/nginx/certs:ro&quot;</span> <span class=\"hljs-literal\">-v</span> <span class=\"hljs-string\">&quot;<span class=\"hljs-variable\">&#x24;</span>{PWD}\\proxy\\auth:/etc/nginx/auth:ro&quot;</span> <span class=\"hljs-literal\">--restart</span> unless<span class=\"hljs-literal\">-stopped</span> nginx:stable\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"198,202"}},{"content":"<pre data-lines=\"205,212\"><code class=\"language-powershell\"><span class=\"hljs-comment\"># Create network</span>\ndocker network create proxy<span class=\"hljs-literal\">-net</span>\n\n<span class=\"hljs-comment\"># Run Grafana, Jenkins and Nginx attached to proxy-net</span>\n<span class=\"hljs-comment\"># In this mode, update proxy_pass upstreams to use container names.</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"205,212"}}],"payload":{"tag":"h2","lines":"137,138"}},{"content":"7) Validate configuration","children":[{"content":"<pre data-lines=\"217,227\"><code class=\"language-powershell\"><span class=\"hljs-comment\"># Check HTTP -&gt; HTTPS redirect</span>\n<span class=\"hljs-built_in\">curl</span> <span class=\"hljs-literal\">-I</span> http://grafana.local\n\n<span class=\"hljs-comment\"># Access Grafana via HTTPS (skip cert verification if self-signed)</span>\n<span class=\"hljs-built_in\">curl</span> <span class=\"hljs-literal\">-k</span> https://grafana.local\n\n<span class=\"hljs-comment\"># Access Jenkins via HTTPS with Basic Auth</span>\n<span class=\"hljs-built_in\">curl</span> <span class=\"hljs-literal\">-k</span> <span class=\"hljs-literal\">-u</span> admin:StrongPass123 https://jenkins.local\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"217,227"}}],"payload":{"tag":"h2","lines":"213,214"}},{"content":"8) Secure Jenkins specifics","children":[{"content":"Nginx Basic Auth prevents reaching Jenkins before the Jenkins login screen. Configure Jenkins internal security (users, roles) in Jenkins for best control.","children":[],"payload":{"tag":"li","lines":"236,237"}},{"content":"If you want to rely solely on Jenkins&apos; own auth, remove <code>auth_basic</code> for the Jenkins server block.","children":[],"payload":{"tag":"li","lines":"237,239"}}],"payload":{"tag":"h2","lines":"234,235"}},{"content":"9) Troubleshooting","children":[{"content":"<pre data-lines=\"244,247\"><code class=\"language-powershell\">netstat <span class=\"hljs-literal\">-ano</span> | <span class=\"hljs-built_in\">Select-String</span> <span class=\"hljs-string\">&quot;:80|:443|:3000|:8080&quot;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"244,247"}}],"payload":{"tag":"h2","lines":"239,240"}},{"content":"10) Cleanup","children":[{"content":"<pre data-lines=\"255,261\"><code class=\"language-powershell\">docker stop reverse<span class=\"hljs-literal\">-proxy</span> grafana jenkins\ndocker <span class=\"hljs-built_in\">rm</span> reverse<span class=\"hljs-literal\">-proxy</span> grafana jenkins\ndocker network <span class=\"hljs-built_in\">rm</span> proxy<span class=\"hljs-literal\">-net</span>  <span class=\"hljs-comment\"># if created</span>\ndocker volume <span class=\"hljs-built_in\">rm</span> jenkins_home  <span class=\"hljs-comment\"># optional</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"255,261"}}],"payload":{"tag":"h2","lines":"251,252"}},{"content":"11) Optional: docker-compose example","children":[{"content":"<pre data-lines=\"266,309\"><code class=\"language-yaml\"><span class=\"hljs-attr\">version:</span> <span class=\"hljs-string\">&quot;3.8&quot;</span>\n<span class=\"hljs-attr\">services:</span>\n  <span class=\"hljs-attr\">grafana:</span>\n    <span class=\"hljs-attr\">image:</span> <span class=\"hljs-string\">grafana/grafana:latest</span>\n    <span class=\"hljs-attr\">ports:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">&quot;3000:3000&quot;</span>\n    <span class=\"hljs-attr\">networks:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">proxy-net</span>\n    <span class=\"hljs-attr\">restart:</span> <span class=\"hljs-string\">unless-stopped</span>\n\n  <span class=\"hljs-attr\">jenkins:</span>\n    <span class=\"hljs-attr\">image:</span> <span class=\"hljs-string\">jenkins/jenkins:lts</span>\n    <span class=\"hljs-attr\">ports:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">&quot;8080:8080&quot;</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">&quot;50000:50000&quot;</span>\n    <span class=\"hljs-attr\">volumes:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">jenkins_home:/var/jenkins_home</span>\n    <span class=\"hljs-attr\">networks:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">proxy-net</span>\n    <span class=\"hljs-attr\">restart:</span> <span class=\"hljs-string\">unless-stopped</span>\n\n  <span class=\"hljs-attr\">nginx:</span>\n    <span class=\"hljs-attr\">image:</span> <span class=\"hljs-string\">nginx:stable</span>\n    <span class=\"hljs-attr\">ports:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">&quot;80:80&quot;</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">&quot;443:443&quot;</span>\n    <span class=\"hljs-attr\">volumes:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">./proxy/conf.d:/etc/nginx/conf.d:ro</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">./proxy/certs:/etc/nginx/certs:ro</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">./proxy/auth:/etc/nginx/auth:ro</span>\n    <span class=\"hljs-attr\">networks:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">proxy-net</span>\n    <span class=\"hljs-attr\">restart:</span> <span class=\"hljs-string\">unless-stopped</span>\n\n<span class=\"hljs-attr\">volumes:</span>\n  <span class=\"hljs-attr\">jenkins_home:</span>\n\n<span class=\"hljs-attr\">networks:</span>\n  <span class=\"hljs-attr\">proxy-net:</span>\n    <span class=\"hljs-attr\">driver:</span> <span class=\"hljs-string\">bridge</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"266,309"}}],"payload":{"tag":"h2","lines":"262,263"}},{"content":"Issues Encountered and Resolutions","children":[],"payload":{"tag":"h2","lines":"310,311"}},{"content":"Security notes","children":[{"content":"Self-signed certificates are acceptable for local testing only.","children":[],"payload":{"tag":"li","lines":"344,345"}},{"content":"Consider using a CA-signed certificate (Let&apos;s Encrypt) and a secure authentication mechanism (OAuth, LDAP, SSO) for production.","children":[],"payload":{"tag":"li","lines":"345,346"}},{"content":"Avoid storing plaintext passwords in scripts &#x2014; use secrets management solutions.","children":[],"payload":{"tag":"li","lines":"346,348"}}],"payload":{"tag":"h2","lines":"342,343"}},{"content":"Validation checklist","children":[{"content":"Hosts entries added for <code>grafana.local</code> and <code>jenkins.local</code>.","children":[],"payload":{"tag":"li","lines":"350,351"}},{"content":"Containers: <code>grafana</code>, <code>jenkins</code>, <code>reverse-proxy</code> running.","children":[],"payload":{"tag":"li","lines":"351,352"}},{"content":"HTTPS works for both domains (certificate present).","children":[],"payload":{"tag":"li","lines":"352,353"}},{"content":"HTTP requests redirect to HTTPS.","children":[],"payload":{"tag":"li","lines":"353,354"}},{"content":"Basic Auth enforced at the proxy for both services.","children":[],"payload":{"tag":"li","lines":"354,356"}}],"payload":{"tag":"h2","lines":"348,349"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
